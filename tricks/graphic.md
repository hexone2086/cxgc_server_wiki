# 图形化桌面

## 当前状态

工厂服务器大多数直接安装了携带桌面环境的操作系统，由于多用户策略，在外部访问时主要使用中转服务器转发或打洞使用 xrdp 连接远程桌面。当前报告的主要问题是由于网络波动带来的卡顿，以及不理解 xrdp 无法多 session 带来的黑屏问题。

## 使用建议

### 非必要不使用

常规代码编辑等完全可以使用某些编辑器的远程插件通过 ssh 连接实现，常见的如 Visual Studio Code 和 JetBrains 系列软件都具有相关插件，可以在远端启动一个 code server，从而实现在远端编写代码和调试的常规操作。如果只是进行代码编辑，则尽量不要使用远程桌面，尤其是无计划地安装桌面软件可能会导致一些环境和依赖冲突，影响到其他用户。

### 使用第三方转发服务器

工厂服务器的自托管转发服务器主要用于 ssh 连接或者临时的 xrdp 连接，带宽较低（3M 以下）且按量计费，故不建议日常使用时通过该服务器转发。日常使用可使用 [sakura frp](https://www.natfrp.com/) 等免费转发隧道，转发本地（127.0.0.1）3389 端口，frpc 客户端可通过 tmux 或者 screen 等终端复用软件运行在后台，保证当前连接退出后仍在运行。关于 sakura frp 远程桌面转发的教程可参见 [远程桌面 (RDP) 穿透指南 | SakuraFrp 帮助文档](https://doc.natfrp.com/app/rdp.html)

## 常见问题

* 可用客户端：Windows 可直接使用自带的”远程桌面连接“软件，Linux 下推荐使用 Remmina
* 黑屏：可能是多端登录导致的，尽量不要和向日葵、ToDesk 等软件混用